

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>External Store &mdash; DataJoint Documentation matlab-v3.3 documentation</title>
  

  
    <link rel="apple-touch-icon" sizes="57x57" href="../_static/favicons/apple-icon-57x57.png"/>
    <link rel="apple-touch-icon" sizes="60x60" href="../_static/favicons/apple-icon-60x60.png"/>
    <link rel="apple-touch-icon" sizes="72x72" href="../_static/favicons/apple-icon-72x72.png"/>
    <link rel="apple-touch-icon" sizes="76x76" href="../_static/favicons/apple-icon-76x76.png"/>
    <link rel="apple-touch-icon" sizes="114x114" href="../_static/favicons/apple-icon-114x114.png"/>
    <link rel="apple-touch-icon" sizes="120x120" href="../_static/favicons/apple-icon-120x120.png"/>
    <link rel="apple-touch-icon" sizes="144x144" href="../_static/favicons/apple-icon-144x144.png"/>
    <link rel="apple-touch-icon" sizes="152x152" href="../_static/favicons/apple-icon-152x152.png"/>
    <link rel="apple-touch-icon", sizes="180x180", href="../_static/favicons/apple-touch-icon.png"/>
    <link rel="icon" type="image/png" sizes="192x192"  href="../_static/favicons/android-icon-192x192.png"/>
    <link rel="icon", type="image/png", sizes="32x32", href="../_static/favicons/favicon-32x32.png"/>
    <link rel="icon", type="image/png", sizes="96x96", href="../_static/favicons/favicon-96x96.png"/>
    <link rel="icon", type="image/png", sizes="16x16", href="../_static/favicons/favicon-16x16.png"/>
    <link rel="manifest", href="../_static/favicons/manifest.json"/>
    <link rel="mask-icon", href="../_static/favicons/safari-pinned-tab.svg", color="#5bbad5"/>
    <meta name="msapplication-TileImage" content="../_static/favicons/mstile-150X150.png"/>
    <meta name="theme-color", content="#ffffff"/>
  

  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/css/dj_doc_theme.css" type="text/css" />
  
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Catamaran" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="DataJoint Documentation matlab-v3.3 documentation" href="../index.html"/>
        <link rel="up" title="Server Administration" href="Admin.html"/>
        <link rel="next" title="Backups and Recovery" href="6-backup.html"/>
        <link rel="prev" title="Bulk Storage Systems" href="4-bulk.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/djDocsLogo.svg" class="logo" />
          
          </a>

          
           
            <span>
            <p class="thisVersion">matlab-v3.3</p> 
            
              <a href="../DataJointDocs_matlab-v3.3.pdf" download>&nbsp;
              <i class="fa fa-file-pdf-o" aria-hidden="true"></i></a>
            
            </span>
          
          
              <ul class="dropdown-versions">
                <li class="menu-text" onclick="dropmenu()">switch versions &nbsp;<i class="fa fa-caret-down" aria-hidden="true"></i></li>
                <div id="dropdown-menu" class="dd-content">
                <li class="version-menu"><a href="/python/v0.13">python-v0.13</a></li>
<li class="version-menu"><a href="/python/v0.12">python-v0.12</a></li>
<li class="version-menu"><a href="/python/v0.11">python-v0.11</a></li>
<li class="version-menu"><a href="/matlab/v3.4">matlab-v3.4</a></li>
<li class="version-menu"><a href="/matlab/v3.3">matlab-v3.3</a></li>
<li class="version-menu"><a href="/matlab/v3.2">matlab-v3.2</a></li>
                </div>
              </ul>
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../intro/Intro.html">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../intro/01-Data-Pipelines.html">Data Pipelines</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../intro/01-Data-Pipelines.html#what-is-a-data-pipeline">What is a data pipeline?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../intro/01-Data-Pipelines.html#what-is-datajoint">What is DataJoint?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../intro/01-Data-Pipelines.html#how-datajoint-works">How DataJoint works</a></li>
<li class="toctree-l3"><a class="reference internal" href="../intro/01-Data-Pipelines.html#real-life-example">Real-life example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../intro/01-Data-Pipelines.html#summary-of-datajoint-features">Summary of DataJoint features</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../intro/02-Teamwork.html">Teamwork</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../intro/02-Teamwork.html#data-management-in-a-science-project">Data management in a science project</a></li>
<li class="toctree-l3"><a class="reference internal" href="../intro/02-Teamwork.html#data-centric-project-organization">Data-centric project organization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../intro/02-Teamwork.html#team-roles">Team roles</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../intro/04-Input-and-Output.html">Input and Output</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../intro/04-Input-and-Output.html#where-is-my-data">Where is my data?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../intro/04-Input-and-Output.html#do-i-have-to-manually-enter-all-my-data-into-the-database">Do I have to manually enter all my data into the database?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../intro/04-Input-and-Output.html#won-t-the-database-get-too-big-if-all-my-data-are-there">Won’t the database get too big if all my data are there?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../intro/04-Input-and-Output.html#why-not-just-process-the-data-and-save-them-back-to-a-file">Why not just process the data and save them back to a file?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../intro/04-Input-and-Output.html#how-do-i-get-my-data-out">How do I get my data out?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../intro/04-Input-and-Output.html#interfaces">Interfaces</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../intro/07-Publishing.html">Publishing Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../intro/07-Publishing.html#provide-access-to-a-datajoint-server">Provide access to a DataJoint server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../intro/07-Publishing.html#containerizing-as-a-datajoint-pipeline">Containerizing as a DataJoint pipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../intro/07-Publishing.html#exporting-into-a-collection-of-files">Exporting into a collection of files</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../intro/08-Progress.html">Progress</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/09-License.html">License</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/12-FAQs.html">FAQs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../intro/12-FAQs.html#how-do-i-use-guis-with-datajoint">How do I use GUIs with DataJoint?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../intro/12-FAQs.html#does-datajoint-support-other-programming-languages">Does DataJoint support other programming languages?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../intro/12-FAQs.html#is-datajoint-another-orm">Is DataJoint another ORM?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../intro/12-FAQs.html#how-can-i-use-datajoint-with-a-lims">How can I use DataJoint with a LIMS?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../intro/12-FAQs.html#what-is-the-difference-between-datajoint-and-alyx">What is the difference between DataJoint and Alyx?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../intro/13-Releases.html">Release Notes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../intro/13-Releases.html#october-15-2020">3.3.2 – October 15, 2020</a></li>
<li class="toctree-l3"><a class="reference internal" href="../intro/13-Releases.html#october-31-2019">3.3.1 – October 31, 2019</a></li>
<li class="toctree-l3"><a class="reference internal" href="../intro/13-Releases.html#february-5-2019">3.2.2 – February 5, 2019</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="Admin.html">Server Administration</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="1-hosting.html">Database Server Hosting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="1-hosting.html#cloud-hosting">Cloud hosting</a></li>
<li class="toctree-l3"><a class="reference internal" href="1-hosting.html#self-hosting">Self hosting</a></li>
<li class="toctree-l3"><a class="reference internal" href="1-hosting.html#general-server-hardware-support-requirements">General server / hardware support requirements</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="2-configuration.html">Relational Database Server</a><ul>
<li class="toctree-l3"><a class="reference internal" href="2-configuration.html#hardware-considerations">Hardware considerations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="2-configuration.html#cpu">CPU</a></li>
<li class="toctree-l4"><a class="reference internal" href="2-configuration.html#ram">RAM</a></li>
<li class="toctree-l4"><a class="reference internal" href="2-configuration.html#disk">Disk</a></li>
<li class="toctree-l4"><a class="reference internal" href="2-configuration.html#networking">Networking</a></li>
<li class="toctree-l4"><a class="reference internal" href="2-configuration.html#general-recommendations">General recommendations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="2-configuration.html#large-scale-installations">Large-scale installations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="2-configuration.html#master-slave-replication">Master-slave replication</a></li>
<li class="toctree-l4"><a class="reference internal" href="2-configuration.html#multi-master-replication">Multi-master replication</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="2-configuration.html#recommendations">Recommendations</a></li>
<li class="toctree-l3"><a class="reference internal" href="2-configuration.html#docker">Docker</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="3-accounts.html">User Management</a><ul>
<li class="toctree-l3"><a class="reference internal" href="3-accounts.html#grouping-with-wildcards">Grouping with Wildcards</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="4-bulk.html">Bulk Storage Systems</a><ul>
<li class="toctree-l3"><a class="reference internal" href="4-bulk.html#why-external-bulk-storage">Why External Bulk Storage?</a><ul>
<li class="toctree-l4"><a class="reference internal" href="4-bulk.html#cost">Cost</a></li>
<li class="toctree-l4"><a class="reference internal" href="4-bulk.html#flexibility">Flexibility</a></li>
<li class="toctree-l4"><a class="reference internal" href="4-bulk.html#performance">Performance</a></li>
<li class="toctree-l4"><a class="reference internal" href="4-bulk.html#data-sharing">Data Sharing</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="4-bulk.html#bulk-storage-scenarios">Bulk Storage Scenarios</a></li>
<li class="toctree-l3"><a class="reference internal" href="4-bulk.html#bulk-storage-considerations">Bulk Storage Considerations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="4-bulk.html#performance-characteristics">Performance Characteristics</a></li>
<li class="toctree-l4"><a class="reference internal" href="4-bulk.html#network-traffic">Network Traffic</a></li>
<li class="toctree-l4"><a class="reference internal" href="4-bulk.html#data-coherency">Data Coherency</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">External Store</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#principles-of-operation">Principles of operation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cleanup">Cleanup</a></li>
<li class="toctree-l3"><a class="reference internal" href="#migration-between-datajoint-v0-11-and-v0-12">Migration between DataJoint v0.11 and v0.12</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="6-backup.html">Backups and Recovery</a><ul>
<li class="toctree-l3"><a class="reference internal" href="6-backup.html#cloud-hosted-backups">Cloud hosted backups</a></li>
<li class="toctree-l3"><a class="reference internal" href="6-backup.html#disk-based-backup">Disk-based backup</a></li>
<li class="toctree-l3"><a class="reference internal" href="6-backup.html#mysqldump">MySQLDump</a></li>
<li class="toctree-l3"><a class="reference internal" href="6-backup.html#percona-xtrabackup">Percona XTraBackup</a></li>
<li class="toctree-l3"><a class="reference internal" href="6-backup.html#locking-and-ddl-issues">Locking and DDL issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="6-backup.html#replication-and-snapshots-for-backup">Replication and snapshots for backup</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../setup/Setup.html">Client Setup</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../setup/01-Install-and-Connect.html">Install and Connect</a></li>
<li class="toctree-l2"><a class="reference internal" href="../setup/01-Install-and-Connect.html#other-configuration-settings">Other Configuration Settings</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../setup/01-Install-and-Connect.html#tls-configuration">TLS Configuration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../setup/02-DataJoint-Python-Windows-Install-Guide.html">DataJoint Python Windows Install Guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../setup/02-DataJoint-Python-Windows-Install-Guide.html#quick-steps">Quick steps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../setup/02-DataJoint-Python-Windows-Install-Guide.html#step-1-install-python">Step 1: install Python</a></li>
<li class="toctree-l3"><a class="reference internal" href="../setup/02-DataJoint-Python-Windows-Install-Guide.html#step-2-verify-installation">Step 2: verify installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../setup/02-DataJoint-Python-Windows-Install-Guide.html#step-3-install-datajoint">Step 3: install DataJoint</a></li>
<li class="toctree-l3"><a class="reference internal" href="../setup/02-DataJoint-Python-Windows-Install-Guide.html#optional-step-4-install-packages-for-erd-support">(Optional) step 4: install packages for ERD support</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../setup/02-DataJoint-Python-Windows-Install-Guide.html#install-graphviz">Install Graphviz</a></li>
<li class="toctree-l4"><a class="reference internal" href="../setup/02-DataJoint-Python-Windows-Install-Guide.html#install-pydotplus">Install PyDotPlus</a></li>
<li class="toctree-l4"><a class="reference internal" href="../setup/02-DataJoint-Python-Windows-Install-Guide.html#install-matplotlib">Install Matplotlib</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../setup/02-DataJoint-Python-Windows-Install-Guide.html#optional-step-5-install-jupyter-notebook">(Optional) step 5: install Jupyter Notebook</a></li>
<li class="toctree-l3"><a class="reference internal" href="../setup/02-DataJoint-Python-Windows-Install-Guide.html#git-for-windows">Git for Windows</a></li>
<li class="toctree-l3"><a class="reference internal" href="../setup/02-DataJoint-Python-Windows-Install-Guide.html#mysql-for-windows">MySQL for Windows</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../concepts/Concepts.html">Concepts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../concepts/01-Data-Model.html">Data Model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../concepts/01-Data-Model.html#what-is-a-data-model">What is a data model?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../concepts/01-Data-Model.html#relational-data-model">Relational data model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../concepts/01-Data-Model.html#core-principles-of-the-relational-data-model">Core principles of the relational data model</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../concepts/01-Data-Model.html#datajoint-is-a-refinement-of-the-relational-data-model">DataJoint is a refinement of the relational data model</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/02-Terminology.html">Terminology</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../concepts/02-Terminology.html#datajoint-databases-schemas-packages-and-modules">DataJoint: databases, schemas, packages, and modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../concepts/02-Terminology.html#base-tables">Base tables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../concepts/02-Terminology.html#relvars-and-relation-values">Relvars and relation values</a></li>
<li class="toctree-l3"><a class="reference internal" href="../concepts/02-Terminology.html#metadata">Metadata</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/03-Normalization.html">Entity Normalization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../concepts/03-Normalization.html#criteria-of-a-well-formed-entity-set">Criteria of a well-formed entity set</a></li>
<li class="toctree-l3"><a class="reference internal" href="../concepts/03-Normalization.html#entity-normalization-in-schema-design">Entity normalization in schema design</a></li>
<li class="toctree-l3"><a class="reference internal" href="../concepts/03-Normalization.html#entity-normalization-in-data-queries">Entity normalization in data queries</a></li>
<li class="toctree-l3"><a class="reference internal" href="../concepts/03-Normalization.html#examples-of-poor-normalization">Examples of poor normalization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../concepts/03-Normalization.html#indirect-attributes">Indirect attributes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../concepts/03-Normalization.html#repeated-attributes">Repeated attributes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../concepts/03-Normalization.html#attributes-that-do-not-apply-to-all-entities">Attributes that do not apply to all entities</a></li>
<li class="toctree-l4"><a class="reference internal" href="../concepts/03-Normalization.html#transient-attributes">Transient attributes</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/04-Integrity.html">Data Integrity</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../concepts/04-Integrity.html#entity-integrity">Entity integrity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../concepts/04-Integrity.html#referential-integrity">Referential integrity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../concepts/04-Integrity.html#group-integrity">Group integrity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../concepts/04-Integrity.html#relationships">Relationships</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../definition/Definition.html">Data Definition</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../definition/01-Creating-Schemas.html">Creating Schemas</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../definition/01-Creating-Schemas.html#schemas">Schemas</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../definition/01-Creating-Schemas.html#manual">Manual</a></li>
<li class="toctree-l4"><a class="reference internal" href="../definition/01-Creating-Schemas.html#automatic">Automatic</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../definition/01-Creating-Schemas.html#working-with-existing-data">Working with existing data</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../definition/02-Creating-Tables.html">Creating Tables</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../definition/02-Creating-Tables.html#classes-represent-tables">Classes represent tables</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../definition/02-Creating-Tables.html#data-tiers">Data tiers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../definition/02-Creating-Tables.html#defining-a-table">Defining a table</a></li>
<li class="toctree-l3"><a class="reference internal" href="../definition/02-Creating-Tables.html#valid-class-names">Valid class names</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../definition/03-Table-Definition.html">Table Definition</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../definition/03-Table-Definition.html#table-creation-on-the-database-server">Table creation on the database server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../definition/03-Table-Definition.html#changing-the-definition-of-an-existing-table">Changing the definition of an existing table</a></li>
<li class="toctree-l3"><a class="reference internal" href="../definition/03-Table-Definition.html#reverse-engineering-the-table-definition">Reverse-engineering the table definition</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../definition/03-Table-Definition.html#examples">Examples</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../definition/04-Definition-Syntax.html">Definition Syntax</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../definition/04-Definition-Syntax.html#attribute-names">Attribute names</a></li>
<li class="toctree-l3"><a class="reference internal" href="../definition/04-Definition-Syntax.html#default-values">Default values</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../definition/05-Data-Tiers.html">Data Tiers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../definition/05-Data-Tiers.html#internal-conventions-for-naming-tables">Internal conventions for naming tables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../definition/05-Data-Tiers.html#part-tables">Part tables</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../definition/06-Datatypes.html">Datatypes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../definition/06-Datatypes.html#most-common-datatypes">Most common datatypes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../definition/06-Datatypes.html#less-common-but-supported-datatypes">Less common (but supported) datatypes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../definition/06-Datatypes.html#special-datajoint-only-datatypes">Special DataJoint-only datatypes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../definition/06-Datatypes.html#datatypes-not-yet-supported">Datatypes not (yet) supported</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../definition/06.5-External-Data.html">External Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../definition/06.5-External-Data.html#file-attachment-datatype">File Attachment Datatype</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../definition/06.5-External-Data.html#configuration-usage">Configuration &amp; Usage</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../definition/06.5-External-Data.html#filepath-datatype">Filepath Datatype</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../definition/06.5-External-Data.html#id2">Configuration &amp; Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../definition/06.5-External-Data.html#integrity-notes">Integrity Notes</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../definition/07-Primary-Key.html">Primary Key</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../definition/07-Primary-Key.html#primary-keys-in-datajoint">Primary keys in DataJoint</a></li>
<li class="toctree-l3"><a class="reference internal" href="../definition/07-Primary-Key.html#defining-a-primary-key">Defining a primary key</a></li>
<li class="toctree-l3"><a class="reference internal" href="../definition/07-Primary-Key.html#entity-integrity">Entity integrity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../definition/07-Primary-Key.html#datatypes-in-primary-keys">Datatypes in primary keys</a></li>
<li class="toctree-l3"><a class="reference internal" href="../definition/07-Primary-Key.html#choosing-primary-key-attributes">Choosing primary key attributes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../definition/07-Primary-Key.html#using-hashes-as-primary-keys">Using hashes as primary keys</a></li>
<li class="toctree-l4"><a class="reference internal" href="../definition/07-Primary-Key.html#auto-increment"><code class="docutils literal notranslate"><span class="pre">auto_increment</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../definition/10-Dependencies.html">Dependencies</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../definition/10-Dependencies.html#understanding-dependencies">Understanding dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../definition/10-Dependencies.html#defining-a-dependency">Defining a dependency</a></li>
<li class="toctree-l3"><a class="reference internal" href="../definition/10-Dependencies.html#how-dependencies-work">How dependencies work</a></li>
<li class="toctree-l3"><a class="reference internal" href="../definition/10-Dependencies.html#referential-integrity">Referential integrity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../definition/10-Dependencies.html#dependencies-with-renamed-attributes">Dependencies with renamed attributes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../definition/10-Dependencies.html#foreign-key-options">Foreign key options</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../definition/11-ERD.html">ERD</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../definition/11-ERD.html#diagram-notation">Diagram notation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../definition/11-ERD.html#diagramming-an-entire-schema">Diagramming an entire schema</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../definition/11-ERD.html#initializing-with-a-single-table">Initializing with a single table</a></li>
<li class="toctree-l4"><a class="reference internal" href="../definition/11-ERD.html#adding-erds-together">Adding ERDs together</a></li>
<li class="toctree-l4"><a class="reference internal" href="../definition/11-ERD.html#expanding-erds-upstream-and-downstream">Expanding ERDs upstream and downstream</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../definition/12-Example.html">Manual Tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../definition/13-Lookup-Tables.html">Lookup Tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../definition/14-Drop.html">Drop</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../definition/14-Drop.html#dropping-part-tables">Dropping part tables</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../existing/Existing.html">Work with Existing Pipelines</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../existing/5-Loading-Classes.html">Loading Classes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../existing/5-Loading-Classes.html#creating-a-virtual-class">Creating a virtual class</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../manipulation/Manipulation.html">Data Manipulation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../manipulation/0-Manipulation.html">Manipulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manipulation/1-Insert.html">Insert</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../manipulation/1-Insert.html#batched-inserts">Batched inserts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manipulation/1-Insert.html#server-side-inserts">Server-side inserts</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../manipulation/2-Delete.html">Delete</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../manipulation/2-Delete.html#examples">Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manipulation/2-Delete.html#deleting-from-part-tables">Deleting from part tables</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../manipulation/3-Cautious-Update.html">Cautious Update</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manipulation/4-Transactions.html">Transactions</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../queries/Queries.html">Queries</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../queries/01-Queries.html">Query Objects</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../queries/01-Queries.html#checking-for-returned-entities">Checking for returned entities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../queries/01-Queries.html#normalization-in-queries">Normalization in queries</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../queries/02-Example-Schema.html">Example Schema</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../queries/02-Example-Schema.html#example-schema-erd">Example schema ERD</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../queries/03-Fetch.html">Fetch</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../queries/03-Fetch.html#fetch-the-primary-key">Fetch the primary key</a></li>
<li class="toctree-l3"><a class="reference internal" href="../queries/03-Fetch.html#fetch-entire-query">Fetch entire query</a></li>
<li class="toctree-l3"><a class="reference internal" href="../queries/03-Fetch.html#as-separate-variables">As separate variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../queries/03-Fetch.html#obtaining-the-primary-key-along-with-individual-values">Obtaining the primary key along with individual values</a></li>
<li class="toctree-l3"><a class="reference internal" href="../queries/03-Fetch.html#rename-and-calculate">Rename and calculate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../queries/03-Fetch.html#sorting-and-limiting-the-results">Sorting and limiting the results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../queries/04-Iteration.html">Iteration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../queries/05-Operators.html">Operators</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../queries/05-Operators.html#principles-of-relational-algebra">Principles of relational algebra</a></li>
<li class="toctree-l3"><a class="reference internal" href="../queries/05-Operators.html#matching-entities">Matching entities</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../queries/05-Operators.html#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../queries/05-Operators.html#join-compatibility">Join compatibility</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../queries/06-Restriction.html">Restriction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../queries/06-Restriction.html#restriction-operators-and">Restriction operators <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> and <code class="docutils literal notranslate"><span class="pre">-</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../queries/06-Restriction.html#restriction-by-a-table">Restriction by a table</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../queries/06-Restriction.html#restriction-by-a-table-with-no-common-attributes">Restriction by a table with no common attributes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../queries/06-Restriction.html#restriction-by-an-empty-table">Restriction by an empty table</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../queries/06-Restriction.html#restriction-by-a-mapping">Restriction by a mapping</a></li>
<li class="toctree-l3"><a class="reference internal" href="../queries/06-Restriction.html#restriction-by-a-string">Restriction by a string</a></li>
<li class="toctree-l3"><a class="reference internal" href="../queries/06-Restriction.html#restriction-by-a-collection">Restriction by a collection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../queries/06-Restriction.html#restriction-by-a-boolean-expression">Restriction by a Boolean expression</a></li>
<li class="toctree-l3"><a class="reference internal" href="../queries/06-Restriction.html#restriction-by-a-query">Restriction by a query</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../queries/07-Join.html">Join</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../queries/07-Join.html#join-operator">Join operator <code class="docutils literal notranslate"><span class="pre">*</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../queries/07-Join.html#principles-of-joins">Principles of joins</a></li>
<li class="toctree-l4"><a class="reference internal" href="../queries/07-Join.html#examples-of-joins">Examples of joins</a></li>
<li class="toctree-l4"><a class="reference internal" href="../queries/07-Join.html#properties-of-join">Properties of join</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../queries/08-Proj.html">Proj</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../queries/08-Proj.html#simple-projection">Simple projection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../queries/08-Proj.html#renaming">Renaming</a></li>
<li class="toctree-l3"><a class="reference internal" href="../queries/08-Proj.html#calculations">Calculations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../queries/09-Aggr.html">Aggr</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../queries/09-Aggr.html#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../queries/10-Union.html">Union</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../queries/10-Union.html#union-operator">Union operator <code class="docutils literal notranslate"><span class="pre">+</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../queries/10-Union.html#principles-of-union">Principles of union</a></li>
<li class="toctree-l4"><a class="reference internal" href="../queries/10-Union.html#examples-of-union">Examples of union</a></li>
<li class="toctree-l4"><a class="reference internal" href="../queries/10-Union.html#properties-of-union">Properties of union</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../queries/11-Universal-Sets.html">Universal Sets</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../computation/Computation.html">Computation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../computation/01-autopopulate.html">Auto-populate</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../computation/01-autopopulate.html#make">Make</a></li>
<li class="toctree-l3"><a class="reference internal" href="../computation/01-autopopulate.html#populate">Populate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../computation/01-autopopulate.html#populate-options">Populate options</a></li>
<li class="toctree-l3"><a class="reference internal" href="../computation/01-autopopulate.html#progress">Progress</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../computation/02-keysource.html">Key Source</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../computation/02-keysource.html#default-key-source">Default key source</a></li>
<li class="toctree-l3"><a class="reference internal" href="../computation/02-keysource.html#custom-key-source">Custom key source</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../computation/03-master-part.html">Master-Part Relationship</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../computation/03-master-part.html#populating">Populating</a></li>
<li class="toctree-l3"><a class="reference internal" href="../computation/03-master-part.html#deleting">Deleting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../computation/03-master-part.html#multiple-parts">Multiple parts</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../computation/04-transactions.html">Transactions in Make</a></li>
<li class="toctree-l2"><a class="reference internal" href="../computation/05-distributed-computing.html">Distributed Computing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../computation/05-distributed-computing.html#job-reservations">Job reservations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../computation/05-distributed-computing.html#managing-connections">Managing connections</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../community/Community.html">Community</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../community/01-Publications.html">Publications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../community/02-Contribute.html">Contribute</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../community/02-Contribute.html#which-issue-should-i-contribute-towards">1) Which issue should I contribute towards?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../community/02-Contribute.html#what-is-the-proper-etiquette-for-proposing-changes-as-contribution">2) What is the proper etiquette for proposing changes as contribution?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../community/02-Contribute.html#how-can-i-track-the-progress-of-an-issue-that-has-been-assigned">3) How can I track the progress of an issue that has been assigned?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../community/02-Contribute.html#what-is-the-release-process-how-do-i-know-when-my-merged-contribution-will-officially-make-it-into-a-release">4) What is the release process? How do I know when my merged contribution will officially make it into a release?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../community/02-Contribute.html#i-am-not-yet-too-comfortable-contributing-but-would-like-to-engage-the-community-what-is-the-policy-on-community-engagement">5) I am not yet too comfortable contributing but would like to engage the community. What is the policy on community engagement?</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../community/02-Contribute.html#a-generally-how-do-i-perform">5a) Generally, how do I perform <strong>__________</strong>?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../community/02-Contribute.html#b-i-just-encountered-this-error-how-can-i-resolve-it">5b) I just encountered this error, how can I resolve it?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../community/02-Contribute.html#c-i-just-encountered-this-error-and-i-am-sure-it-is-a-bug-how-do-i-report-it">5c) I just encountered this error and I am sure it is a bug, how do I report it?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../community/02-Contribute.html#d-i-have-an-idea-or-new-feature-request-how-do-i-submit-it">5d) I have an idea or new feature request, how do I submit it?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../community/02-Contribute.html#e-i-am-curious-why-the-maintainers-choose-to-i-e-questions-that-are-opinionated-in-nature-with-answers-that-some-might-disagree">5e) I am curious why the maintainers choose to <strong>__________</strong>? i.e. questions that are ‘opinionated’ in nature with answers that some might disagree.</a></li>
<li class="toctree-l4"><a class="reference internal" href="../community/02-Contribute.html#f-what-is-the-timeline-or-roadmap-for-the-release-of-certain-supported-features">5f) What is the timeline or roadmap for the release of certain supported features?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../community/02-Contribute.html#g-i-need-urgent-help-best-suited-for-live-debugging-how-can-i-reach-out-directly">5g) I need urgent help best suited for live debugging, how can I reach out directly?</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../community/03-Engagements.html">Engagements</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../community/03-Engagements.html#multi-lab-collaboratives">Multi-lab collaboratives</a></li>
<li class="toctree-l3"><a class="reference internal" href="../community/03-Engagements.html#invidiual-labs">Invidiual Labs</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">DataJoint Documentation</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="Admin.html">Server Administration</a> &raquo;</li>
        
      <li>External Store</li>
    
    
      <li class="wy-breadcrumbs-aside">
      <!--  -->
        <!-- <p class="thisVersion">matlab-v3.3</p> -->
      <!--  -->
      <a href="http://datajoint.io" target="_blank">
        <img id="breadcrumbsThumbnail" src="../_static/themeImages/datajointIOfull.svg">
      </a>
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="external-store">
<span id="external"></span><h1>External Store<a class="headerlink" href="#external-store" title="Permalink to this headline">¶</a></h1>
<p>DataJoint organizes most of its data in a relational database.
Relational databases excel at representing relationships between entities and storing structured data.
However, relational databases are not particularly well-suited for storing large continuous chunks of data such as images, signals, and movies.
An attribute of type <code class="docutils literal notranslate"><span class="pre">longblob</span></code> can contain an object up to 4 GiB in size (after compression) but storing many such large objects may hamper the performance of queries on the entire table.
A good rule of thumb is that objects over 10 MiB in size should not be put in the relational database.
In addition, storing data in cloud-hosted relational databases (e.g. AWS RDS) may be more expensive than in cloud-hosted simple storage systems (e.g. AWS S3).</p>
<p>DataJoint allows the use of <cite>external</cite> storage to store large data objects within its relational framework but outside of the main database.</p>
<p>Defining an externally-stored attribute is used using the notation <code class="docutils literal notranslate"><span class="pre">blob&#64;storename</span></code> (see also: <a class="reference internal" href="../definition/03-Table-Definition.html#definitions"><span class="std std-ref">definition syntax</span></a>) and works the same way as a <code class="docutils literal notranslate"><span class="pre">longblob</span></code> attribute from the users perspective. However, its data are stored in an external storage system rather than in the relational database.</p>
<p>Various systems can play the role of external storage, including a shared file system accessible to all team members with access to these objects or a cloud storage solutions such as AWS S3.</p>
<p>For example, the following table stores motion-aligned two-photon movies.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span># Motion aligned movies
-&gt; twophoton.Scan
---
aligned_movie :  blob@external  # motion-aligned movie in &#39;external&#39; store
</pre></div>
</div>
<p>All <a class="reference internal" href="../manipulation/1-Insert.html#insert"><span class="std std-ref">insert</span></a> and <a class="reference internal" href="../queries/03-Fetch.html#fetch"><span class="std std-ref">fetch</span></a> operations work identically for <cite>external</cite> attributes as they do for <cite>blob</cite> attributes, with the same serialization protocol.
Similar to <cite>blobs</cite>, <cite>external</cite> attributes cannot be used in restriction conditions.</p>
<p>Multiple external storage configurations may be used simultaneously with the <code class="docutils literal notranslate"><span class="pre">&#64;storename</span></code> portion of the attribute definition determining the storage location.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span># Motion aligned movies
-&gt; twophoton.Scan
---
aligned_movie :  blob@external-raw  # motion-aligned movie in &#39;external-raw&#39; store
</pre></div>
</div>
<section id="principles-of-operation">
<span id="principles"></span><h2>Principles of operation<a class="headerlink" href="#principles-of-operation" title="Permalink to this headline">¶</a></h2>
<p>External storage is organized to emulate individual attribute values in the relational database.
DataJoint organizes external storage to preserve the same data integrity principles as in relational storage.</p>
<ol class="arabic simple">
<li><p>The external storage locations are specified in the DataJoint connection configuration with one specification for each store.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>External storage is not yet implemented in MATLAB.
The feature will be added in an upcoming release: <a class="reference external" href="https://github.com/datajoint/datajoint-matlab/issues/143">https://github.com/datajoint/datajoint-matlab/issues/143</a></p>
</div>
<ol class="arabic" start="2">
<li><p>Each schema corresponds to a dedicated folder at the storage location with the same name as the database schema.</p></li>
<li><p>Stored objects are identified by the <a class="reference external" href="https://en.wikipedia.org/wiki/SHA-2">SHA-256</a> hashes (in web-safe base-64 ASCII) of their serialized contents.
This scheme allows for the same object—used multiple times in the same schema—to be stored only once.</p></li>
<li><p>In the <code class="docutils literal notranslate"><span class="pre">external-raw</span></code> storage, the objects are saved as files with the hash as the filename.</p></li>
<li><p>In the <code class="docutils literal notranslate"><span class="pre">external</span></code> storage, external files are stored in a directory layout corresponding to the hash of the filename. By default, this corresponds to the first 2 characters of the hash, followed by the second 2 characters of the hash, followed by the actual file.</p></li>
<li><p>Each database schema has an auxiliary table named <code class="docutils literal notranslate"><span class="pre">~external_&lt;storename&gt;</span></code> for each configured external store.</p>
<p>It is automatically created the first time external storage is used.
The primary key of <code class="docutils literal notranslate"><span class="pre">~external_&lt;storename&gt;</span></code> is the hash of the data (for blobs and attachments) or of the relative paths to the files for filepath-based storage.
Other attributes are the <code class="docutils literal notranslate"><span class="pre">count</span></code> of references by tables in the schema, the <code class="docutils literal notranslate"><span class="pre">size</span></code> of the object in bytes, and the <code class="docutils literal notranslate"><span class="pre">timestamp</span></code> of the last event (creation, update, or deletion).</p>
<p>Below are sample entries in <code class="docutils literal notranslate"><span class="pre">~external_&lt;storename&gt;</span></code>.</p>
<table class="colwidths-auto docutils align-center" id="id2">
<caption><span class="caption-text">~external_raw</span><a class="headerlink" href="#id2" title="Permalink to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>HASH</p></th>
<th class="head"><p>size</p></th>
<th class="head"><p>filepath</p></th>
<th class="head"><p>contents_hash</p></th>
<th class="head"><p>timestamp</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1GEqtEU6JYE OLS4sZHeHDx WQ3JJfLlHVZ io1ga25vd2</p></td>
<td><p>1039536788</p></td>
<td><p>NULL</p></td>
<td><p>NULL</p></td>
<td><p>2017-06-07 23:14:01</p></td>
</tr>
</tbody>
</table>
<p>The fields <cite>filepath</cite> and <cite>contents_hash</cite> relate to the <a class="reference internal" href="../definition/06.5-External-Data.html#filepath"><span class="std std-ref">filepath</span></a> datatype, which will be discussed separately.</p>
</li>
<li><p>Attributes of type <code class="docutils literal notranslate"><span class="pre">&#64;&lt;storename&gt;</span></code> are declared as renamed <a class="reference internal" href="../definition/10-Dependencies.html#dependencies"><span class="std std-ref">foreign keys</span></a> referencing the <code class="docutils literal notranslate"><span class="pre">~external_&lt;storename&gt;</span></code> table (but are not shown as such to the user).</p></li>
<li><p>The <a class="reference internal" href="../manipulation/1-Insert.html#insert"><span class="std std-ref">insert</span></a> operation encodes and hashes the blob data. If an external object is not present in storage for the same hash, the object is saved and if the save operation is successful, corresponding entities in table <code class="docutils literal notranslate"><span class="pre">~external_&lt;storename&gt;</span></code> for that store are created.</p></li>
<li><p>The <a class="reference internal" href="../manipulation/2-Delete.html#delete"><span class="std std-ref">delete</span></a>  operation first deletes the foreign key reference in the target table. The external table entry and actual external object is not actually deleted at this time (<cite>soft-delete</cite>).</p></li>
<li><p>The <a class="reference internal" href="../queries/03-Fetch.html#fetch"><span class="std std-ref">fetch</span></a> operation uses the hash values to find the data.</p></li>
</ol>
<blockquote>
<div><p>In order to prevent excessive network overhead, a special external store named <code class="docutils literal notranslate"><span class="pre">cache</span></code> can be configured.
If the <code class="docutils literal notranslate"><span class="pre">cache</span></code> is enabled, the <code class="docutils literal notranslate"><span class="pre">fetch</span></code> operation need not access <code class="docutils literal notranslate"><span class="pre">~external_&lt;storename&gt;</span></code> directly.
Instead <code class="docutils literal notranslate"><span class="pre">fetch</span></code> will retrieve the cached object without downloading directly from the <cite>real</cite> external store.</p>
</div></blockquote>
<ol class="arabic simple" start="11">
<li><p>Cleanup is performed regularly when the database is in light use or off-line.</p></li>
<li><p>DataJoint never removes objects from the local <code class="docutils literal notranslate"><span class="pre">cache</span></code> folder.
The <code class="docutils literal notranslate"><span class="pre">cache</span></code> folder may just be periodically emptied entirely or based on file access date.
If dedicated <code class="docutils literal notranslate"><span class="pre">cache</span></code> folders are maintained for each schema, then a special procedure will be provided to remove all objects that are no longer listed in <code class="docutils literal notranslate"><span class="pre">~external_&lt;storename&gt;</span></code>.</p></li>
</ol>
<p>Data removal from external storage is separated from the delete operations to ensure that data are not lost in race conditions between inserts and deletes of the same objects, especially in cases of transactional processing or in processes that are likely to get terminated.
The cleanup steps are performed in a separate process when the risks of race conditions are minimal.
The process performing the cleanups must be isolated to prevent interruptions resulting in loss of data integrity.</p>
</section>
<section id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h2>
<p>The following steps must be performed to enable external storage:</p>
<ol class="arabic simple">
<li><p>Assign external location settings for each storage as shown in the <a class="reference internal" href="#principles"><span class="std std-ref">Step 1</span></a> example above.</p></li>
</ol>
<blockquote>
<div><p>Use <code class="docutils literal notranslate"><span class="pre">dj.set</span></code> for configuration.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">protocol</span></code> [<cite>s3</cite>, <cite>file</cite>] Specifies whether <cite>s3</cite> or <cite>file</cite> external storage is desired.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">endpoint</span></code> [<cite>s3</cite>] Specifies the remote endpoint to the external data for all schemas as well as the target port.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bucket</span></code> [<cite>s3</cite>] Specifies the appropriate <cite>s3</cite> bucket organization.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">location</span></code> [<cite>s3</cite>, <cite>file</cite>] Specifies the subdirectory within the root or bucket of store to preserve data. External objects are thus stored remotely with the following path structure: <code class="docutils literal notranslate"><span class="pre">&lt;bucket</span> <span class="pre">(if</span> <span class="pre">applicable)&gt;/&lt;location&gt;/&lt;schema_name&gt;/&lt;subfolding_strategy&gt;/&lt;object&gt;</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">access_key</span></code> [<cite>s3</cite>] Specifies the access key credentials for accessing the external location.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">secret_key</span></code> [<cite>s3</cite>] Specifies the secret key credentials for accessing the external location.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">secure</span></code> [<cite>s3</cite>] Optional specification to establish secure external storage connection with TLS (aka SSL, HTTPS). Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Optionally, for each schema specify the <code class="docutils literal notranslate"><span class="pre">cache</span></code> folder for local fetch cache.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The cache folder is not yet implemented in MATLAB.
The feature will be added in an upcoming release: <a class="reference external" href="https://github.com/datajoint/datajoint-matlab/issues/143">https://github.com/datajoint/datajoint-matlab/issues/143</a></p>
</div>
</section>
<section id="cleanup">
<h2>Cleanup<a class="headerlink" href="#cleanup" title="Permalink to this headline">¶</a></h2>
<p>Deletion of records containing externally stored blobs is a <cite>soft-delete</cite> which only removes the database-side records from the database.
To cleanup the external tracking table or the actual external files, a separate process is provided as follows.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>External storage is not yet implemented in MATLAB.
The feature will be added in an upcoming release: <a class="reference external" href="https://github.com/datajoint/datajoint-matlab/issues/143">https://github.com/datajoint/datajoint-matlab/issues/143</a></p>
</div>
</section>
<section id="migration-between-datajoint-v0-11-and-v0-12">
<h2>Migration between DataJoint v0.11 and v0.12<a class="headerlink" href="#migration-between-datajoint-v0-11-and-v0-12" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please read carefully if you have used external storage in DataJoint v0.11!</p>
</div>
<p>The initial implementation of external storage was reworked for
DataJoint v0.12. These changes are backward-incompatible with DataJoint
v0.11 so care should be taken when upgrading. This section outlines
some details of the change and a general process for upgrading to a
format compatible with DataJoint v0.12 when a schema rebuild is not
desired.</p>
<p>The primary changes to the external data implementation are:</p>
<blockquote>
<div><ul class="simple">
<li><p>The external object tracking mechanism was modified. Tracking tables
were extended for additional external datatypes and split into
per-store tables to improve database performance in schemas with
many external objects.</p></li>
<li><p>The external storage format was modified to use a nested subfolder
structure (<cite>folding</cite>) to improve performance and interoperability
with some filesystems that have limitations or performance problems
when storing large numbers of files in single directories.</p></li>
</ul>
</div></blockquote>
<p>Depending on the circumstances, the simplest way to migrate data to
v0.12 may be to drop and repopulate the affected schemas. This will construct
the schema and storage structure in the v0.12 format and save the need for
database migration. When recreation is not possible or is not preferred
to upgrade to DataJoint v0.12, the following process should be followed:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Stop write activity to all schemas using external storage.</p></li>
<li><p>Perform a full backup of your database(s).</p></li>
<li><p>Upgrade your DataJoint installation to v0.12</p></li>
<li><p>Adjust your external storage configuration (in <cite>datajoint.config</cite>)
to the new v0.12 configuration format (see above).</p></li>
<li><p>Migrate external tracking tables for each schema to use the new format. For instance in Python:</p></li>
</ol>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">datajoint.migrate</span> <span class="k">as</span> <span class="nn">migrate</span>
    <span class="o">&gt;&gt;&gt;</span> <span class="n">db_schema_name</span><span class="o">=</span><span class="s1">&#39;schema_1&#39;</span>
    <span class="o">&gt;&gt;&gt;</span> <span class="n">external_store</span><span class="o">=</span><span class="s1">&#39;raw&#39;</span>
    <span class="o">&gt;&gt;&gt;</span> <span class="n">migrate</span><span class="o">.</span><span class="n">migrate_dj011_external_blob_storage_to_dj012</span><span class="p">(</span><span class="n">db_schema_name</span><span class="p">,</span> <span class="n">external_store</span><span class="p">)</span>

<span class="mi">6</span><span class="p">)</span> <span class="n">Verify</span> <span class="n">pipeline</span> <span class="n">functionality</span> <span class="n">after</span> <span class="n">this</span> <span class="n">process</span> <span class="n">has</span> <span class="n">completed</span><span class="o">.</span> <span class="n">For</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">Python</span><span class="p">:</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">myschema</span><span class="o">.</span><span class="n">TableWithExternal</span><span class="o">.</span><span class="n">fetch</span><span class="p">(</span><span class="s1">&#39;external_field&#39;</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This migration function is provided on a best-effort basis, and will
convert the external tracking tables into a format which is compatible
with DataJoint v0.12. While we have attempted to ensure correctness
of the process, all use-cases have not been heavily tested. Please be sure to fully
back-up your data and be prepared to investigate problems with the
migration, should they occur.</p>
</div>
<p>Please note:</p>
<blockquote>
<div><ul class="simple">
<li><p>The migration only migrates the tracking table format and does not
modify the backing file structure to support <cite>folding</cite>. The DataJoint
v0.12 logic is able to work with this format, but to take advantage
of the new backend storage, manual adjustment of the tracking table
and files, or a full rebuild of the schema should be performed.</p></li>
<li><p>Additional care to ensure all clients are using v0.12 should be
taken after the upgrade. Legacy clients may incorrectly create data
in the old format which would then need to be combined or otherwise
reconciled with the data in v0.12 format. You might wish to take
the opportunity to version-pin your installations so that future
changes requiring controlled upgrades can be coordinated on a system
wide basis.</p></li>
</ul>
</div></blockquote>
</section>
</section>


            <a class="community-guide-tab" target="_blank" href="https://datajoint.slack.com/join/shared_invite/enQtMjkwNjQxMjI5MDk0LWIzN2ExYzBiM2NlODQxN2YxODAxNWQwOWVkNjVmZDkzYzEwMjM5OWJkM2EwYTRhYmRiZDgxMjUzYjBlZWVjMzA">
              <div>
                Talk to the Community
              </div>
            </a>
           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="6-backup.html" class="btn btn-neutral float-right" title="Backups and Recovery" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="4-bulk.html" class="btn btn-neutral" title="Bulk Storage Systems" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017-2022, DataJoint.
    <a href="http://tutorials.datajoint.io" target="_blank">
      <img id="footerThumbnail" src="../_static/themeImages/djTutorialLogo.svg">
    </a>
    <br />
    <a href="https://datajoint.io" target="_blank">DataJoint.io</a>
    </p>

  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  
  <script type="text/javascript" src="../_static/js/dropdown.js"></script>

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>